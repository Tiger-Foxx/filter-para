# Tiger-Fox C++ Hybrid Network Filtering System

ğŸ”¥ **High-Performance Multi-Worker Inline Network Filtering**

## Overview

Tiger-Fox is a research-grade network filtering system implementing **hybrid multi-worker architecture** for inline packet filtering with true L7 HTTP analysis via optimized TCP reassembly.

**Key Features:**
- âœ… Multi-worker parallel processing (hash-based flow dispatch)
- âœ… True TCP reassembly for HTTP L7 analysis
- âœ… Unified L3/L4/L7 rule filtering
- âœ… Zero-copy packet processing
- âœ… CPU affinity and NUMA awareness
- âœ… Real NFQUEUE inline filtering

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NFQUEUE (Kernel)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚      PacketHandler          â”‚
         â”‚   (Queue Management)        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Hash Dispatcher     â”‚
        â”‚  (4-tuple based)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Worker 0â”‚   â”‚ Worker 1â”‚   â”‚ Worker Nâ”‚
â”‚ Core 0  â”‚   â”‚ Core 1  â”‚   â”‚ Core N  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
              â”‚ L3 â†’ L4 â†’ â”‚
              â”‚    L7     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Quick Start

### Installation (Ubuntu 22.04+)

```bash
# Install dependencies
chmod +x install_deps.sh
sudo ./install_deps.sh

# Build
chmod +x build.sh
./build.sh

# Run
sudo ./build/tiger-fox --workers 8
```

### Usage

```bash
# Auto-detect CPU cores
sudo ./build/tiger-fox

# Specify worker count
sudo ./build/tiger-fox --workers 8

# Custom queue number
sudo ./build/tiger-fox --queue 1

# Debug mode
sudo ./build/tiger-fox --debug

# Help
./build/tiger-fox --help
```

## CloudLab Testing

```
INJECTOR (wrk)         FILTER               SERVER (nginx)
10.10.1.10      â†’      10.10.1.1/2.1    â†’   10.10.2.20
                       [tiger-fox]
```

**From injector:**
```bash
wrk -t 12 -c 400 -d 30s --latency http://10.10.2.20/
```

## Performance

- **Throughput:** 10Gbps+ on modern hardware
- **Latency:** <100Î¼s per packet (without reassembly)
- **Reassembly:** <500Î¼s for complete HTTP request
- **Rules:** 600+ rules evaluated per packet
- **Scalability:** Linear with CPU cores

## Project Structure

```
tiger-fox-cpp/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.cpp                    # Entry point
â”‚   â”œâ”€â”€ tiger_system.h/.cpp         # System orchestration
â”‚   â”œâ”€â”€ utils.h/.cpp                # Utilities
â”‚   â”œâ”€â”€ engine/
â”‚   â”‚   â”œâ”€â”€ rule_engine.h/.cpp      # Rule evaluation engine
â”‚   â”‚   â””â”€â”€ worker_pool.h/.cpp      # Worker management
â”‚   â”œâ”€â”€ handlers/
â”‚   â”‚   â”œâ”€â”€ packet_handler.h/.cpp   # NFQUEUE interface
â”‚   â”‚   â””â”€â”€ tcp_reassembler.h/.cpp  # TCP stream reconstruction
â”‚   â””â”€â”€ loaders/
â”‚       â””â”€â”€ rule_loader.h/.cpp      # JSON rule parser
â”œâ”€â”€ rules/
â”‚   â””â”€â”€ tiger_rules.json            # 600+ filtering rules
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ build.sh
â””â”€â”€ README.md
```

## Rule Format

```json
{
  "rules": [
    {
      "id": "block_sql_injection",
      "layer": 7,
      "type": "http_uri_regex",
      "values": ["(?i)(union|select).*from"],
      "action": "drop"
    }
  ]
}
```

## Requirements

- **OS:** Linux (Ubuntu 20.04+)
- **Privileges:** Root (for NFQUEUE)
- **RAM:** 4GB minimum
- **CPU:** Multi-core recommended

## License

Academic research project - Master's in Computer Engineering

---

**Author:** Pascal DONFACK ARTHUR MONTGOMERY (Tiger Fox)  
**Last Updated:** 2025-09-30
